 --- BIN FILE READ: one_element
  10702 INCLUDE 'one_element';
  10703   PROCEDURE PICK INDEX MAPARR SPNRARR;
  10704     VARIABLE I 1;
  10705     VARIABLE J 1;
  10706     LOOP I 1 TWOND;
  10707       MSC(I) := MAPARR(I, INDEX);
  10708       ENDLOOP;
  10709     LOOP I 1 3;
  10710       LOOP J 1 3;
  10711         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  10712         ENDLOOP;
  10713       ENDLOOP;
  10714     ENDPROCEDURE;
  10715   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  10716     VARIABLE J 1;
  10717     WRITE 6 '* '&ST(START);
  10718     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  10719     LOOP J (START+1) TO;
  10720       WRITE 6 '**       '&ST(J);
  10721       PICK J MAPARR SPNRARR; %PICK:10703
  10722       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10723       UPDATE 1 1; %UPDATE: 1261
  10724       ENDLOOP;
  10725     LOOP J FROM (START-1);
  10726       WRITE 6 '**       '&ST(J);
  10727       PICK J MAPARR SPNRARR; %PICK:10703
  10728       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10729       UPDATE 1 1; %UPDATE: 1261
  10730       ENDLOOP;
  10731     ENDPROCEDURE;
  10732   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  10733     VARIABLE NUM1 1;
  10734     VARIABLE NUM2 1;
  10735     VARIABLE OBJ 1;
  10736     IF COORD='X';
  10737       NUM1:=1;
  10738       NUM2:=2;
  10739       AL0:=0;
  10740       BET0:=20.0;
  10741       GAM0:=1.0/BET0;
  10742       ELSEIF COORD='Y';
  10743       NUM1:=3;
  10744       NUM2:=4;
  10745       AL0:=0;
  10746       BET0:=3;
  10747       GAM0:=1.0/BET0;
  10748       ELSEIF LO(1);
  10749       WRITE 6 'UNKNOWN COORDINATE';
  10750       ENDIF;
  10751     FIT AL0 BET0 GAM0;
  10752       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  10753       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  10754       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  10755       ENDFIT 1E-20 5000 1 OBJ;
  10756     ENDPROCEDURE;
  10757   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  10758     VARIABLE J 1;
  10759     VARIABLE NUM1 1;
  10760     VARIABLE NUM2 1;
  10761     IF COORD='X';
  10762       NUM1:=1;
  10763       NUM2:=2;
  10764       ELSEIF COORD='Y';
  10765       NUM1:=3;
  10766       NUM2:=4;
  10767       ELSEIF LO(1);
  10768       WRITE 6 'UNKNOWN COORDINATE';
  10769       ENDIF;
  10770     UM; %UM: 1488
  10771     BETS(1):=BET0;
  10772     OPENF 800 TAG 'REPLACE';
  10773     WRITE 800 ST(BETS(1))&'     '&ST(0);
  10774     LOOP J 1 NUM_ELE;
  10775       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10715
  10776       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  10777       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  10778       UM; %UM: 1488
  10779       ENDLOOP;
  10780     CLOSEF 800;
  10781     ENDPROCEDURE;
  10782   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  10783     VARIABLE NUM1 1;
  10784     VARIABLE NUM2 1;
  10785     VARIABLE OBJ 1;
  10786     IF COORD='X';
  10787       NUM1:=1;
  10788       NUM2:=2;
  10789       D0:=0;
  10790       DPR0:=0;
  10791       ELSEIF COORD='Y';
  10792       NUM1:=3;
  10793       NUM2:=4;
  10794       D0:=0;
  10795       DPR0:=0;
  10796       ELSEIF LO(1);
  10797       WRITE 6 'UNKNOWN COORDINATE';
  10798       ENDIF;
  10799     FIT D0 DPR0;
  10800       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  10801       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  10802       ENDFIT 1E-20 5000 1 OBJ;
  10803     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  10804     WRITE 6 D0 DPR0;
  10805     ENDPROCEDURE;
  10806   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  10807     VARIABLE J 1;
  10808     VARIABLE NUM1 1;
  10809     VARIABLE NUM2 1;
  10810     IF COORD='X';
  10811       NUM1:=1;
  10812       NUM2:=2;
  10813       ELSEIF COORD='Y';
  10814       NUM1:=3;
  10815       NUM2:=4;
  10816       ELSEIF LO(1);
  10817       WRITE 6 'UNKNOWN COORDINATE';
  10818       ENDIF;
  10819     UM; %UM: 1488
  10820     DS(1):=D0;
  10821     OPENF 800 TAG 'REPLACE';
  10822     WRITE 800 ST(DS(1))&'     '&ST(0);
  10823     LOOP J 1 NUM_ELE;
  10824       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10715
  10825       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  10826       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  10827       UM; %UM: 1488
  10828       ENDLOOP;
  10829     CLOSEF 800;
  10830     ENDPROCEDURE;
  10831   PROCEDURE MAIN;
  10832     VARIABLE GAMMA 1;
  10833     VARIABLE SGX1 1;
  10834     VARIABLE SGX2 1;
  10835     VARIABLE SGY1 1;
  10836     VARIABLE SGY2 1;
  10837     VARIABLE EB1 1;
  10838     VARIABLE ALPHAX0 1;
  10839     VARIABLE BETAX0 1;
  10840     VARIABLE GAMMAX0 1;
  10841     VARIABLE BETAXS 1 313;
  10842     VARIABLE ALPHAY0 1;
  10843     VARIABLE BETAY0 1;
  10844     VARIABLE GAMMAY0 1;
  10845     VARIABLE BETAYS 1 313;
  10846     VARIABLE DISPX0 1;
  10847     VARIABLE DISPXPR0 1;
  10848     VARIABLE DISPXS 1 313;
  10849     VARIABLE DISPY0 1;
  10850     VARIABLE DISPYPR0 1;
  10851     VARIABLE DISPYS 1 313;
  10852     VARIABLE MAPARR1 1000 6 313;
  10853     VARIABLE SPNRARR1 1000 3 3 313;
  10854     VARIABLE NUM_ELE 1;
  10855     GAMMA := 1.143914;
  10856     NUM_ELE := 64;
  10857     NUM_ELE := 66;
  10858     NUM_ELE := 52;
  10859     NUM_ELE := 43;
  10860     NUM_ELE := 2;
  10861     OV 3 3 0; %OV:  969
  10862     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10611
  10863     EB1 := 132.6739162456733;
  10864     EB1 := 130.0;
  10865     SGX1 :=  0.0;
  10866     SGY1  := 0.0;
  10867     SGX2 :=  0.0;
  10868     SGY2  := 0.0;
  10869     BETAX0:=1.15239 ;
  10870     ALPHAX0:=-1.84023E-16;
  10871     BETAY0:=11.7531;
  10872     ALPHAY0:=-1.13782E-16;
  10873     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  10874     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  10875     DISPX0:=0.00952606;
  10876     DISPXPR0:=0.000;
  10877     DISPY0:=0.0;
  10878     DISPYPR0:=0.0;
  10879     LATTICE SGX1 SGY1 SGX2 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10648

  10880     PM 6; %PM: 1574
  10881     WRITE 6 '++++++++++ Magnetic Rigidity';
  10882     WRITE 6 CONS(CHIM);
  10883     WRITE 6 ME(3,6); %ME:  516
  10884     BETS 'BETAX' 'X' NUM_ELE ALPHAX0 BETAX0 GAMMAX0 BETAXS MAPARR1 SPN
                  RARR1; %BETS:10757
  10885     BETS 'BETAY' 'Y' NUM_ELE ALPHAY0 BETAY0 GAMMAY0 BETAYS MAPARR1 SPN
                  RARR1; %BETS:10757
  10886     DISPS 'DISPX' 'X' NUM_ELE DISPX0 DISPXPR0 DISPXS MAPARR1 SPNRARR1;
                   %DISPS:10806
  10887     ENDPROCEDURE;
  10888   PROCEDURE RUN;
  10889     MAIN; %MAIN:10831
  10890     ENDPROCEDURE;
  10891   RUN; %RUN:10888
