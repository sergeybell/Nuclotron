 --- BIN FILE READ: seq_Nuclotron_Mod_maps
  10843 INCLUDE 'seq_Nuclotron_Mod_maps';
  10844   PROCEDURE PICK INDEX MAPARR SPNRARR;
  10845     VARIABLE I 1;
  10846     VARIABLE J 1;
  10847     LOOP I 1 TWOND;
  10848       MSC(I) := MAPARR(I, INDEX);
  10849       ENDLOOP;
  10850     LOOP I 1 3;
  10851       LOOP J 1 3;
  10852         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  10853         ENDLOOP;
  10854       ENDLOOP;
  10855     ENDPROCEDURE;
  10856   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  10857     VARIABLE J 1;
  10858     WRITE 6 '* '&ST(START);
  10859     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  10860     LOOP J (START+1) TO;
  10861       WRITE 6 '**       '&ST(J);
  10862       PICK J MAPARR SPNRARR; %PICK:10844
  10863       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10864       UPDATE 1 1; %UPDATE: 1261
  10865       ENDLOOP;
  10866     LOOP J FROM (START-1);
  10867       WRITE 6 '**       '&ST(J);
  10868       PICK J MAPARR SPNRARR; %PICK:10844
  10869       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  10870       UPDATE 1 1; %UPDATE: 1261
  10871       ENDLOOP;
  10872     ENDPROCEDURE;
  10873   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  10874     VARIABLE NUM1 1;
  10875     VARIABLE NUM2 1;
  10876     VARIABLE OBJ 1;
  10877     IF COORD='X';
  10878       NUM1:=1;
  10879       NUM2:=2;
  10880       AL0:=0;
  10881       BET0:=20.0;
  10882       GAM0:=1.0/BET0;
  10883       ELSEIF COORD='Y';
  10884       NUM1:=3;
  10885       NUM2:=4;
  10886       AL0:=0;
  10887       BET0:=3;
  10888       GAM0:=1.0/BET0;
  10889       ELSEIF LO(1);
  10890       WRITE 6 'UNKNOWN COORDINATE';
  10891       ENDIF;
  10892     FIT AL0 BET0 GAM0;
  10893       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  10894       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  10895       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  10896       ENDFIT 1E-20 5000 1 OBJ;
  10897     ENDPROCEDURE;
  10898   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  10899     VARIABLE J 1;
  10900     VARIABLE NUM1 1;
  10901     VARIABLE NUM2 1;
  10902     IF COORD='X';
  10903       NUM1:=1;
  10904       NUM2:=2;
  10905       ELSEIF COORD='Y';
  10906       NUM1:=3;
  10907       NUM2:=4;
  10908       ELSEIF LO(1);
  10909       WRITE 6 'UNKNOWN COORDINATE';
  10910       ENDIF;
  10911     UM; %UM: 1488
  10912     BETS(1):=BET0;
  10913     OPENF 800 TAG 'REPLACE';
  10914     WRITE 800 ST(BETS(1))&'     '&ST(0);
  10915     LOOP J 1 NUM_ELE;
  10916       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10856
  10917       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  10918       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  10919       UM; %UM: 1488
  10920       ENDLOOP;
  10921     CLOSEF 800;
  10922     ENDPROCEDURE;
  10923   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  10924     VARIABLE NUM1 1;
  10925     VARIABLE NUM2 1;
  10926     VARIABLE OBJ 1;
  10927     IF COORD='X';
  10928       NUM1:=1;
  10929       NUM2:=2;
  10930       D0:=0;
  10931       DPR0:=0;
  10932       ELSEIF COORD='Y';
  10933       NUM1:=3;
  10934       NUM2:=4;
  10935       D0:=0;
  10936       DPR0:=0;
  10937       ELSEIF LO(1);
  10938       WRITE 6 'UNKNOWN COORDINATE';
  10939       ENDIF;
  10940     FIT D0 DPR0;
  10941       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  10942       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  10943       ENDFIT 1E-20 5000 1 OBJ;
  10944     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  10945     WRITE 6 D0 DPR0;
  10946     ENDPROCEDURE;
  10947   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  10948     VARIABLE J 1;
  10949     VARIABLE NUM1 1;
  10950     VARIABLE NUM2 1;
  10951     IF COORD='X';
  10952       NUM1:=1;
  10953       NUM2:=2;
  10954       ELSEIF COORD='Y';
  10955       NUM1:=3;
  10956       NUM2:=4;
  10957       ELSEIF LO(1);
  10958       WRITE 6 'UNKNOWN COORDINATE';
  10959       ENDIF;
  10960     UM; %UM: 1488
  10961     DS(1):=D0;
  10962     OPENF 800 TAG 'REPLACE';
  10963     WRITE 800 ST(DS(1))&'     '&ST(0);
  10964     LOOP J 1 NUM_ELE;
  10965       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:10856
  10966       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  10967       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  10968       UM; %UM: 1488
  10969       ENDLOOP;
  10970     CLOSEF 800;
  10971     ENDPROCEDURE;
  10972   PROCEDURE MAIN;
  10973     VARIABLE GAMMA 1;
  10974     VARIABLE SGX1 1;
  10975     VARIABLE SGX2 1;
  10976     VARIABLE SGY1 1;
  10977     VARIABLE SGY2 1;
  10978     VARIABLE EB1 1;
  10979     VARIABLE ALPHAX0 1;
  10980     VARIABLE BETAX0 1;
  10981     VARIABLE GAMMAX0 1;
  10982     VARIABLE BETAXS 1 313;
  10983     VARIABLE ALPHAY0 1;
  10984     VARIABLE BETAY0 1;
  10985     VARIABLE GAMMAY0 1;
  10986     VARIABLE BETAYS 1 313;
  10987     VARIABLE DISPX0 1;
  10988     VARIABLE DISPXPR0 1;
  10989     VARIABLE DISPXS 1 313;
  10990     VARIABLE DISPY0 1;
  10991     VARIABLE DISPYPR0 1;
  10992     VARIABLE DISPYS 1 313;
  10993     VARIABLE MAPARR1 1000 6 313;
  10994     VARIABLE SPNRARR1 1000 3 3 313;
  10995     VARIABLE NUM_ELE 1;
  10996     GAMMA := 1.143914;
  10997     NUM_ELE := 64;
  10998     NUM_ELE := 66;
  10999     NUM_ELE := 52;
  11000     NUM_ELE := 43;
  11001     NUM_ELE := 2;
  11002     NUM_ELE := 54;
  11003     OV 3 3 0; %OV:  969
  11004     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10611
  11005     EB1 := -130.0;
  11006     SGX1 :=  0.0;
  11007     SGY1  := 0.0;
  11008     SGX2 :=  0.0;
  11009     SGY2  := 0.0;
  11010     BETAX0:=1.15239 ;
  11011     ALPHAX0:=-1.84023E-16;
  11012     BETAY0:=11.7531;
  11013     ALPHAY0:=-1.13782E-16;
  11014     BETAX0:=1.28561 ;
  11015     ALPHAX0:=0.32205;
  11016     BETAY0:=13.2084;
  11017     ALPHAY0:=-2.66837;
  11018     BETAX0:=2.39604;
  11019     ALPHAX0:=-5.49393E-16;
  11020     BETAY0:=12.0604;
  11021     ALPHAY0:=1.34646E-15;
  11022     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  11023     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  11024     DISPX0:=0.00507595;
  11025     DISPXPR0:=0.0;
  11026     DISPY0:=0.0;
  11027     DISPYPR0:=0.0;
  11028     LATTICE SGX1 SGY1 SGX2 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10648

  11029     PM 6; %PM: 1574
  11030     WRITE 6 '++++++++++ Magnetic Rigidity';
  11031     WRITE 6 CONS(CHIM);
  11032     WRITE 6 ME(3,6); %ME:  516
  11033     DISPS 'DISPX' 'X' NUM_ELE DISPX0 DISPXPR0 DISPXS MAPARR1 SPNRARR1;
                   %DISPS:10947
  11034     ENDPROCEDURE;
  11035   PROCEDURE RUN;
  11036     MAIN; %MAIN:10972
  11037     ENDPROCEDURE;
  11038   RUN; %RUN:11035
